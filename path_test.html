<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>パス確認テスト</title>
  <style>
    body { 
      font-family: Arial, sans-serif; 
      padding: 20px; 
      background: #f5f5f5;
    }
    .test-item { 
      margin: 20px 0; 
      padding: 15px; 
      background: white; 
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .success { border-left: 4px solid #4CAF50; }
    .error { border-left: 4px solid #f44336; }
    img, video { 
      max-width: 300px; 
      height: auto; 
      border: 2px solid #ddd;
      border-radius: 4px;
    }
    .path-info {
      background: #e3f2fd;
      padding: 10px;
      border-radius: 4px;
      margin: 10px 0;
      font-family: monospace;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <h1>🔍 ファイルパス確認テスト</h1>
  
  <div class="test-item">
    <h3>📁 現在のページの場所</h3>
    <div class="path-info" id="currentPath"></div>
  </div>

  <div class="test-item">
    <h3>🎬 動画ファイルテスト</h3>
    <div class="path-info">テスト対象: images/research/marmoset_movie.mp4</div>
    
    <video controls width="300" style="display: block; margin: 10px 0;">
      <source src="images/research/marmoset_movie.mp4" type="video/mp4">
      動画を読み込めません
    </video>
    
    <div id="videoStatus">読み込み中...</div>
  </div>

  <div class="test-item">
    <h3>🖼️ 画像ファイルテスト（参考）</h3>
    <div class="path-info">テスト対象: images/research/marmoset.jpg</div>
    
    <img src="images/research/marmoset.jpg" alt="マーモセット画像" style="display: block; margin: 10px 0;">
    <div id="imageStatus">読み込み中...</div>
  </div>

  <div class="test-item">
    <h3>🔗 代替パステスト</h3>
    <div class="path-info">テスト対象: ./images/research/marmoset_movie.mp4</div>
    
    <video controls width="300" style="display: block; margin: 10px 0;">
      <source src="./images/research/marmoset_movie.mp4" type="video/mp4">
      動画を読み込めません
    </video>
    
    <div id="altVideoStatus">読み込み中...</div>
  </div>

  <div class="test-item">
    <h3>📊 ファイル存在確認</h3>
    <div id="fileChecks"></div>
  </div>

  <script>
    // 現在のページ情報を表示
    document.getElementById('currentPath').innerHTML = `
      URL: ${window.location.href}<br>
      Protocol: ${window.location.protocol}<br>
      Host: ${window.location.host}<br>
      Pathname: ${window.location.pathname}
    `;

    // 動画読み込み状況をチェック
    const video1 = document.querySelector('video');
    const video2 = document.querySelectorAll('video')[1];
    const image = document.querySelector('img');

    // 最初の動画
    video1.addEventListener('loadeddata', () => {
      document.getElementById('videoStatus').innerHTML = '✅ 動画読み込み成功！';
      document.querySelector('.test-item:nth-child(2)').classList.add('success');
    });

    video1.addEventListener('error', (e) => {
      document.getElementById('videoStatus').innerHTML = '❌ 動画読み込み失敗: ' + e.message;
      document.querySelector('.test-item:nth-child(2)').classList.add('error');
    });

    // 2番目の動画（代替パス）
    video2.addEventListener('loadeddata', () => {
      document.getElementById('altVideoStatus').innerHTML = '✅ 代替パス動画読み込み成功！';
      document.querySelector('.test-item:nth-child(4)').classList.add('success');
    });

    video2.addEventListener('error', (e) => {
      document.getElementById('altVideoStatus').innerHTML = '❌ 代替パス動画読み込み失敗: ' + e.message;
      document.querySelector('.test-item:nth-child(4)').classList.add('error');
    });

    // 画像
    image.addEventListener('load', () => {
      document.getElementById('imageStatus').innerHTML = '✅ 画像読み込み成功！';
      document.querySelector('.test-item:nth-child(3)').classList.add('success');
    });

    image.addEventListener('error', (e) => {
      document.getElementById('imageStatus').innerHTML = '❌ 画像読み込み失敗';
      document.querySelector('.test-item:nth-child(3)').classList.add('error');
    });

    // ファイル存在確認
    async function checkFiles() {
      const paths = [
        'images/research/marmoset_movie.mp4',
        './images/research/marmoset_movie.mp4',
        'images/research/marmoset.jpg',
        'images/research/'
      ];

      const results = [];
      
      for (const path of paths) {
        try {
          const response = await fetch(path, { method: 'HEAD' });
          const size = response.headers.get('content-length');
          const sizeText = size ? ` (${(size/1024/1024).toFixed(2)}MB)` : '';
          
          if (response.ok) {
            results.push(`✅ ${path}${sizeText}`);
          } else {
            results.push(`❌ ${path} - Status: ${response.status}`);
          }
        } catch (error) {
          results.push(`❌ ${path} - Error: ${error.message}`);
        }
      }

      document.getElementById('fileChecks').innerHTML = results.map(r => 
        `<div class="path-info">${r}</div>`
      ).join('');
    }

    // ページ読み込み完了後にファイルチェック実行
    setTimeout(checkFiles, 1000);
  </script>
</body>
</html>
